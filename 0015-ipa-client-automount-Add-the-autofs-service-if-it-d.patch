From b58b5180ffe8dccee9b291cc12542f24f973f166 Mon Sep 17 00:00:00 2001
From: Jakub Hrozek <jhrozek@redhat.com>
Date: Thu, 25 Oct 2012 19:59:21 +0200
Subject: [PATCH] ipa-client-automount: Add the autofs service if it doesn't exist yet

https://fedorahosted.org/freeipa/ticket/3201
---
 ipa-client/ipa-install/ipa-client-automount |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

diff --git a/ipa-client/ipa-install/ipa-client-automount b/ipa-client/ipa-install/ipa-client-automount
index d9a63e7ee5e627fbd2ed3d14dcb0e55e5ff82843..7ea69ec12be12f1e0d50abc9ef59a979aa25c7a1 100755
--- a/ipa-client/ipa-install/ipa-client-automount
+++ b/ipa-client/ipa-install/ipa-client-automount
@@ -154,6 +154,9 @@ def configure_autofs_sssd(fstore, statestore, autodiscover, options):
     except Exception, e:
         sys.exit(e)
 
+    if 'autofs' not in sssdconfig.list_services():
+        sssdconfig.new_service('autofs')
+
     try:
         sssdconfig.activate_service('autofs')
     except SSSDConfig.NoServiceError:
-- 
1.6.0.6

